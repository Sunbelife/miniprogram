##请帖项目接口说明文档

## 小程序部分

card_id 格式：20181109 + 000A

### 首页请帖列表

- 一览：
  - /get_edited_model_list
  - /create_model
  - /copy_model
  - /del_model

- create_model - 创建请帖：

```
api: /create_model

请求方式：get
请求参数：
{
	time:"xxx",
	change_log:"xxx" // 储存最后一次修改
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- copy_model - 复制请帖：

```
api: /copy_model

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- del_model - 删除请帖：

```
api: /del_model

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- get_edited_model_list - 已编辑请帖列表：

```
api: /get_edited_model_list

请求方式：get
请求参数：
{
	username:"xxx"
}
返回：
{
	[
		card_id:"xxx",
		cover_pic_url:"xxx"
	],
	[
		card_id:"xxx",
		cover_pic_url:"xxx"
	]
}
```

### 请帖操作

- 一览：
	- /change_pic

- change_pic - 修改请帖图片：

```
api: /change_pic

请求方式：get
请求参数：
{
	card_id:"xxx",
	pic_url:"xxx"
}
返回：
{
	time:"xxx",
	username:"xxx",
	message:"xxx"
}
```

### 弹幕界面

- 一览：
  - /get_barrage_msg
  - /send_barrage_msg

- get_barrage_msg - 获取弹幕：

```
api: /get_barrage_msg

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	time:"xxx",
	username:"xxx",
	message:"xxx"
	// card_id 错误时返回 250
}
```

- send_barrage_msg - 发送弹幕：

```
api: /send_barrage_msg
请求方式：post
请求参数：
{
	time:"xxx",
	username:"xxx",
	message:"xxx",
	card_id:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

### 赴宴填写界面

- 一览：

	- /send_attend_info

- send_attend_info - 赴宴信息填写：

```
api: /send_attend_info

请求方式：post
请求参数：
{
	time:"xxx",
	username:"xxx",
	is_attend:"xxx",
	transit:"xxx",
	phone_num:"xxx",
	attend_num:"xxx",
	card_id:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

### 设置页面

- 一览：
	- /get_card_settings
	- /get_card_info
	- /send_card_info

- get_card_settings - 卡片设置信息获取：

```
api: /get_card_settings

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	is_barrage_on:"",
	bgm_name:""
}
```

- get_music_list - 音乐获取接口：

```
api: /get_music_list

请求方式：get
请求参数：无

返回：
[
	{
		mc_name:"xxx",
		mc_url:"xxx",
		mc_type:"xxx"
	},
	{
		mc_name:"xxx",
		mc_url:"xxx",
		mc_type:"xxx"
	}
]
```

- get_card_info - 请帖信息获取接口：

```
api: /get_card_info

请求方式：get
请求参数：无

返回：
{
	boy_name:"xxx",
	girl_name:"xxx",
	marr_date:"xxx",
	marr_time:"xxx",
	contact_num:"xxx",
	marr_addr:"xxx"
}
```

- send_card_info - 请帖信息发送接口：

```
api: /send_card_info

请求方式：get
请求参数：
{
	card_id:"xxx",
	boy_name:"xxx",
	girl_name:"xxx",
	marr_date:"xxx",
	marr_time:"xxx",
	contact_num:"xxx",
	marr_addr:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

### 宾客消息界面

- 一览：
  - /get_wish_msg
  - /get_wish_msg_is_read
  - /reply_wish_msg
  - /get_attend_info
  - /send_wish_msg_is_read

- get_wish_msg - 祝愿消息获取接口：

```
api: /get_wish_msg

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	[
		title:"xxx",
		content:"xxx",
		time:"xxx",
		is_read:"xxx",
		msg_id:"xxx"
	],
	[
		title:"xxx",
		content:"xxx",
		time:"xxx",
		is_read:"xxx",
		msg_id:"xxx"
	]
}
```

- get_wish_msg_is_read - 祝愿消息阅读数量获取接口：

```
api: /get_wish_msg_is_read

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	is_read_sum:"xxx"
}
```

- send_wish_msg_is_read - 祝愿消息已读反馈接口：

```
api: /send_wish_msg_is_read

请求方式：get
请求参数：
{
	msg_id:"xxx"
	is_read:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- reply_wish_msg - 祝愿消息回复接口：

```
api: /reply_wish_msg

请求方式：post
请求参数：
{
	card_id:"xxx",
	msg_id:"xxx",
	time:"xxx",
	is_read:"xxx",
	reply_msg:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- get_attend_info - 赴宴消息获取接口：

```
api: /get_attend_info

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	[
		{
			attend_name:"xxx",
			attend_transit:"xxx",
			phone_num:"xxx",
			attend_num:"xxx",
			attend_time:"xxx",
			is_attend:"xxx"
		}
	]
}
```

### 管理系统接口

- 一览：
  - /verify_user
  - /get_music_mange_list
  - /upload_music
  - /get_attend_mange_list
  - /get_model_list
  - /del_model

- del_model - 模板删除接口：

```
api: /del_model

请求方式：post
请求参数：
{
	model_id:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- get_model_list - 模板信息获取接口：

```
api: /get_model_list

请求方式：get
请求参数：无
返回：
[
	{
		model_name:"xxx",
		model_pic_url:"xxx",
		model_type:"xxx",
		model_id:"xxx"
	},
	{
		model_name:"xxx",
		model_pic_url:"xxx",
		model_type:"xxx",
		model_id:"xxx"
	}
]
```

- get_attend_mange_list - 赴宴人员信息获取接口：

```
api: /get_attend_mange_list

请求方式：post
请求参数：无
返回：
[
	{
		merry_man:"xxx",
		attend_man : [
		{
			man_name:"xxx",
			man_num:"xxx",
			man_sum:"xxx",
			man_type:"xxx",
			man_time:"xxx"
		},
		{
			man_name:"xxx",
			man_num:"xxx",
			man_sum:"xxx",
			man_type:"xxx",
			man_time:"xxx"
		}
		]
	},
	{
		merry_man:"xxx",
		attend_man : [
		{
			man_name:"xxx",
			man_num:"xxx",
			man_sum:"xxx",
			man_type:"xxx",
			man_time:"xxx"
		},
		{
			man_name:"xxx",
			man_num:"xxx",
			man_sum:"xxx",
			man_type:"xxx",
			man_time:"xxx"
		}
		]
	}
]
```

- upload_music - 音乐上传接口：

```
api: /upload_music

请求方式：post
请求参数：
{
	mc_name:"xxx",
	mc_file:"xxx",
	mc_time:"xxx",
	mc_type:"xxx"
}
返回：
{
	result:"status_code" // 正确 200，错误 250
}
```

- get_music_mange_list - 音乐信息获取接口：

```
api: /get_music_mange_list

请求方式：get
请求参数：
{
	type:"xxx"
}
返回：
[
	{
		mc_name:"xxx",
		mc_time:"xxx",
		mc_type:"xxx"
	},
	{
		mc_name:"xxx",
		mc_time:"xxx",
		mc_type:"xxx"
	}
]
```

- verify_user - 用户验证接口：

```
api: /verify_user

请求方式：get
请求参数：
{
	user_name:"xxx",
	user_passwd:"xxx"
}
返回：
{
	result:"status_code" // 正确返回用户 type 1 为管理员，0 为普通用户，错误返回 250
}
```

### 分享接口

- 一览：
	- /gen_pic
	
- gen_pic - 生成二维码接口：

```
api: /gen_pic

请求方式：get
请求参数：
{
	card_id:"xxx"
}
返回：
{
	pic_url:"xxx"
}
```





## 管理后台部分

### 登录部分

- 一览：
  - /verify_user
- verify_user - 验证用户登录：

```
api: /verify_user

请求方式：get
请求参数：
{
	user_name:"xxx",
	pass_word:"xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

### 音乐管理

- 一览：
  - /get_music_list
  - /upload_music
  - /del_music

- get_music_list - 获取音乐列表：

```
api: /get_music_list

请求方式：get
请求参数：
{
	music_type:"xxx" //音乐类型，两种 1 -> 中文、2 -> 外文
}
返回：
[
    {
        "music_id": 1, 
        "music_name": "东风破", 
        "music_type": "1", 
        "music_time": "2018-12-04", 
        "music_url": "https://www.baidu.com"
    }, 
    {
        "music_id": 2, 
        "music_name": "西风更破", 
        "music_type": "1", 
        "music_time": "2018-12-04", 
        "music_url": "https://www.360.cn"
    }
]
```

- upload_music - 上传音乐

```
api: /upload_music

请求方式：get
请求参数：
{
	music_name: "xxx",
	music_type: "xxx",
	music_time: "xxx",
	raw_file: "xxx" //文件流
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

- del_music - 删除音乐

```
api: /del_music

请求方式：get
请求参数：
{
	music_id: "xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

### 赴宴信息管理

- 一览：
  - /get_attend_info_marry_man
  - /get_attend_info_attend_man
- get_attend_info_marry_man - 获取赴宴结婚人信息

 ```
api: /get_attend_info_marry_man

请求方式：get
请求参数：
{
	无
}
返回：
[
    {
        "marry_id": "xxx", 
        "marry_man": "xxx", 
        "marry_women": "xxx"
    }, 
    {
        "marry_id": "xxx", 
        "marry_man": "xxx", 
        "marry_women": "xxx"
    }
]
 ```

- get_attend_info_attend_man - 获取赴宴人员信息

```
api: /get_attend_info_attend_man

请求方式：get
请求参数：
{
	"marry_id": "xxx"
}
返回：
[
	{
        "attend_man": "xxx",
        "attend_phone_num": “xxx”,
        "attend_person_sum": "xxx",
        "attend_type": "xxx",
        "attend_time": "xxx"
	},
	{
        "attend_man": "xxx",
        "attend_phone_num": “xxx”,
        "attend_person_sum": "xxx",
        "attend_type": "xxx",
        "attend_time": "xxx"
	}
]
```

### 模板管理

- 一览：
  - /get_model_list
  - /del_model
- get_model_list - 获取模板信息

```
api: /get_model_list

请求方式：get
请求参数：
{
	无
}
返回：
[
	{
        "model_id": "xxx",
        "model_pic_url": "xxx",
        "model_time": "xxx"
	},
	{
        "model_id": "xxx",
        "model_pic_url": "xxx",
        "model_time": "xxx"
	}
]
```

- del_model - 删除模板

```
api: /del_model

请求方式：get
请求参数：
{
	"model_id": "xxx"
}
返回：
{
	result:"status_code" // 成功 200，失败 250
}
```

